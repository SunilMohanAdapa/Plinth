Description: Fix hostname parameter.
Author: James Valleroy.

Origin: https://github.com/NickDaly/Plinth/pull/49
Bug: https://github.com/NickDaly/Plinth/pull/49
Forwarded: https://github.com/NickDaly/Plinth/pull/49
Reviewed-By: Petter Reinholdtsen <pere@hungry.com>
Last-Update: 2013-11-04

--- plinth-0.3.0.0.git.20131102.orig/modules/installed/system/config.py
+++ plinth-0.3.0.0.git.20131102/modules/installed/system/config.py
@@ -49,9 +49,13 @@ def get_hostname():
 
 def set_hostname(hostname):
     "Sets machine hostname to hostname"
+
+    # Hostname should be ASCII. If it's unicode but passed our valid_hostname check, convert to ASCII.
+    hostname = str(hostname)
+
     cfg.log.info("Changing hostname to '%s'" % hostname)
     try:
-        privilegedaction_run("hostname-change", [hostname])
+        privilegedaction_run("hostname-change", hostname)
         # don't persist/cache change unless it was saved successfuly
         sys_store = filedict_con(cfg.store_file, 'sys')
         sys_store['hostname'] = hostname
